{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-03-24 16:03:51.949647",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Delivery Note",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{% set company = frappe.get_doc(\"Company\", doc.company) %}\n<!DOCTYPE html>\n<html>\n<head>\n    <style>\n        body { font-family: Arial, sans-serif; }\n        .header { text-align: center; }\n        .header img { width: 300px;}\n        .company-details { text-align: center; font-size: 13px; margin-bottom: 10px; }\n        .title { font-size: 18px; font-weight: bold; text-align: center; margin-bottom: 2px; }\n        .table { width: 99.80%; border-collapse: collapse;  margin-top: 2px;}\n        .table, .table th, .table td { border: 1px solid black; }\n        .table th, .table td { text-align: center;}\n        .subtotal { font-weight: bold; }\n        @media print {\n            body {\n                margin-top: 0;\n                padding-top: 0;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <img src=\"{{ company.default_letter_head or '/private/files/SW LLP.png' }}\" alt=\"Company Logo\">\n    </div>\n    <div class=\"company-details\">\n        {%- if doc.company_address -%}\n            {%- set address = frappe.get_doc(\"Address\", doc.company_address) -%}\n            <strong>{{ address.address_line1 }}, </strong>\n            {%- if address.address_line2 -%}\n            <strong>{{ address.address_line2 }}</strong><br>\n            {%- endif -%}\n            <strong>{{ address.city }}, {{ address.state }} - {{ address.pincode }} {{ address.country }}</strong> <br>\n        {%- endif -%}\n    \n        {%- if doc.company -%}\n            {%- set company = frappe.get_doc(\"Company\", doc.company) -%}\n            {%- if company.gstin -%}\n                <b>GSTIN: </b>{{ company.gstin }} |\n            {%- endif -%}\n            {%- if company.pan -%}\n                <b> PAN:</b> {{ company.pan }}<br>\n            {%- endif -%}\n            {%- if company.phone_no -%}\n                <b>Contact:</b> {{ company.phone_no }} |\n            {%- endif -%}\n            {%- if company.email -%}\n                <b></b> {{ company.email }} | \n            {%- endif -%}\n            {%- if company.website -%}\n                <b> </b><a href=\"{{ company.website }}\" target=\"_blank\">{{ company.website }}</a>\n            {%- endif -%}\n        {%- endif -%}\n    </div>\n\n    <div class=\"title\" style=\"border: 1px solid #000\">Packing Slip</div>\n\n    <table width=\"100%\">\n        <tr>\n            <td><strong>Invoice No:</strong> {{ doc.name }}</td>\n            <td><strong>No:</strong> {{ doc.naming_series }}</td>\n        </tr>\n        <tr>\n            <td><strong>Vehicle No:</strong> {{ doc.vehicle_no or \"N/A\" }}</td>\n            <td><strong>Date:</strong> {{ doc.posting_date }}</td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"><strong>PO No:</strong> {{ doc.po_no or \"N/A\" }}</td>\n        </tr>\n    </table>\n\n{% set grouped_items = {} %}\n\n{% for item in doc.items %}\n    {% set length = frappe.db.get_value(\"Serial No\", item.serial_no, \"custom_length\") or item.custom_length or 0 %}\n    {% set weight = item.custom_weight or 0 %}\n    {% set box_serial = item.serial_no or \"N/A\" %}\n    {% set item_group = item.item_code %}  {# Grouping only by `item_code` #}\n\n    {# Determine UOM based on item_code pattern #}\n    {% if \"3CF\" in item.item_code %}\n        {% set uom = \"Length\" %}\n        {% set value = length %}\n    {% elif \"FB\" in item.item_code %}\n        {% set uom = \"Length\" %}\n        {% set value = length %}\n    {% elif \"SWW\" in item.item_code %}\n        {% set uom = \"KG\" %}\n        {% set value = weight %}\n    {% elif \"SON\" in item.item_code %}\n    {% set uom = \"Boxes\" %}\n    {% set value = frappe.db.get_value(\"Delivery Note Item\", {\"parent\": doc.name, \"item_code\": item.item_code}, \"qty\") or 0 %}\n\n    {% else %}\n        {% set uom = \"N/A\" %}\n        {% set value = 0 %}\n    {% endif %}\n\n    {% if item_group not in grouped_items %}\n        {% set _ = grouped_items.update({ item_group: [] }) %}\n    {% endif %}\n\n    {% set _ = grouped_items[item_group].append({\n        \"item_code\": item.item_code,\n        \"size\": frappe.db.get_value(\"Item\", item.item_code, \"custom_size_mm\") or \"-\",\n        \"box_serial\": box_serial,\n        \"uom\": uom,\n        \"value\": value\n    }) %}\n{% endfor %}\n\n<table class=\"table\">\n    <thead>\n        <tr>\n            <th>#</th>\n            <th>Product Name</th>\n            <th>Size</th>\n            <th>Box Serial No</th>\n            <th>UOM</th>\n            <th>Values</th>\n        </tr>\n    </thead>\n    {% set ns = namespace(row_index=0, subtotal=0, last_group=\"\") %}\n    <tbody>\n        {% for group, items in grouped_items.items() %}\n            {% set ns.subtotal = 0 %} {# Reset subtotal for each group #}\n            {% for item in items %}\n                {% set ns.row_index = ns.row_index + 1 %}\n                {% set ns.subtotal = ns.subtotal + item.value %} {# Add to subtotal #}\n                <tr>\n                    <td>{{ ns.row_index }}</td>\n                    <td>{{ item.item_code }}</td>\n                    <td>{{ item.size }}</td>\n                    <td>{{ item.box_serial }}</td>\n                    <td>{{ item.uom }}</td>\n                    <td>{{ \"%.3f\"|format(item.value) }}</td>\n                </tr>\n            {% endfor %}\n\n            {# Insert subtotal row when group ends #}\n            <tr class=\"subtotal\">\n                <td colspan=\"5\" style=\"text-align: right; font-weight: bold;\">Subtotal</td>\n                <td style=\"font-weight: bold;\">{{ \"%.3f\"|format(ns.subtotal) }}</td>\n            </tr>\n        {% endfor %}\n    </tbody>\n</table>\n\n\n</table>\n\n</body>\n</html>\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-04-25 12:28:11.303725",
 "modified_by": "Administrator",
 "module": "Sonali",
 "name": "Delivery Note",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}